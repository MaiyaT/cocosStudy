{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "\r\n\r\nvar BoxDrop = require(\"BoxDrop\");\r\nvar BoxItem = require(\"BoxItem\");\r\nvar BoxState = require(\"States\").BoxState;\r\nvar Game_State = require(\"States\").Game_State;\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        box_prefab:{\r\n            default:null,\r\n            type:cc.Prefab,\r\n        },\r\n\r\n        num_rank:{\r\n            default:10,\r\n            tooltip:\"列数\"\r\n        },\r\n\r\n        num_row:{\r\n            default:10,\r\n            tooltip:\"行数\"\r\n        },\r\n\r\n        super_node:{\r\n            default:null,\r\n            type:cc.Node,\r\n        },\r\n\r\n        _gameState:{\r\n            default:Game_State.Start,\r\n            type:Game_State,\r\n        },\r\n\r\n        gamestate:{\r\n            get:function () {\r\n                return this._gameState;\r\n            },\r\n            set:function (value) {\r\n\r\n                if(this._gameState !== value){\r\n                    this._gameState = value;\r\n                    if(value === Game_State.Play){\r\n                        //开始掉落\r\n                        this.updateBeginOriginY();\r\n                    }else  if(value === Game_State.Filling){\r\n                        this.fillInterval = 0;\r\n                    }\r\n\r\n                }\r\n            },\r\n            type:Game_State\r\n        },\r\n\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        Array.prototype.removeByValue = function(arr,val){\r\n\r\n            for (var i = 0; i<arr.length; i++){\r\n                if(arr[i] === val){\r\n                    arr.splice(i,1);\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Array.prototype.filterRepeat = function(){  \r\n        //     //直接定义结果数组  \r\n        //     var arr = [];\r\n        //     if(arr.length > 0){\r\n        //         arr.push(this[0]);\r\n        //     }\r\n\r\n        //     for(var i = 1; i < this.length; i++){    //从数组第二项开始循环遍历此数组  \r\n        //         //对元素进行判断：  \r\n        //         //如果数组当前元素在此数组中第一次出现的位置不是i  \r\n        //         //那么我们可以判断第i项元素是重复的，否则直接存入结果数组  \r\n        //         if(this.indexOf(this[i]) == i){  \r\n        //             arr.push(this[i]);  \r\n        //         }  \r\n        //     }  \r\n        //     return arr;  \r\n        // }  \r\n\r\n        this.rankList = [];\r\n\r\n        this.itemWidth = 100;\r\n        this.itemHeight = 100;\r\n\r\n        this.itemSpace = 5;\r\n\r\n        //this.margin_top = -(cc.director.getWinSize().height)*0.5 + this.itemHeight*this.num_row + this.itemSpace * (this.num_row - 1) + this.itemHeight*0.5;\r\n        //this.margin_bottom = -(cc.director.getWinSize().height)*0.5 - this.itemHeight*0.5;\r\n\r\n        this.margin_top = -(this.super_node.height)*0.5 + this.itemHeight*this.num_row + this.itemSpace * (this.num_row - 1) + this.itemHeight*0.5;\r\n        this.margin_bottom = -(this.super_node.height)*0.5 - this.itemHeight*0.5;\r\n\r\n        this.margin_left =  -this.itemWidth*this.num_rank*0.5 + this.itemSpace*(this.num_rank*0.5-1);\r\n        this.margin_right = this.itemWidth * this.num_rank * 0.5 - this.itemSpace * (this.num_rank * 0.5 - 1);\r\n\r\n        //console.log(\"asds  \" + this.margin_top+\"  \"+this.margin_bottom);\r\n\r\n        this.boxPool = new cc.NodePool(\"BoxDrop\");\r\n\r\n        this.replayGame();\r\n    },\r\n\r\n    //重新开始游戏\r\n    replayGame:function(){\r\n\r\n        this.gamestate = Game_State.Start;\r\n\r\n        var children = this.super_node.children;\r\n\r\n        while(children.length > 0){\r\n            \r\n            for (var i = 0; i < children.length; ++i) {\r\n                this.boxDrop_destroy(children[i].getComponent(\"BoxDrop\"));\r\n            }            \r\n        }\r\n\r\n        //清空ranklist\r\n        var item;\r\n        while (item = this.rankList.shift()) {\r\n            \r\n        }\r\n        \r\n\r\n        console.log(\"清空成功\");\r\n\r\n        //创建所有面板的数据\r\n        for(let index = 0; index<this.num_rank; index++){\r\n            this.createRankContent(index);\r\n        }\r\n\r\n        this.checkPanelEliminatable();\r\n\r\n        this.updateBeginOriginY();\r\n    },\r\n\r\n\r\n    //创建每一列的数据\r\n    createRankContent:function(index){\r\n\r\n        let rank_list = [];\r\n\r\n        let origin_x = this.margin_left + (this.itemWidth+this.itemSpace)*index;\r\n         \r\n        for(let i = 0; i < this.num_row; i++){\r\n\r\n            let box = this.boxDrop_get();\r\n            box.active = true;\r\n\r\n            box.width = this.itemWidth;\r\n            box.height = this.itemHeight;\r\n\r\n            let box_c = box.getComponent(\"BoxDrop\");\r\n            box_c.state_b = BoxState.ENormal;\r\n\r\n            box_c.initBoxItem();\r\n\r\n            box_c.boxItem.begin_x = origin_x;\r\n            box_c.boxItem.begin_y = this.margin_top;\r\n            box_c.boxItem.end_y = this.margin_bottom + (this.itemHeight+this.itemSpace)*(i+1);\r\n            box_c.boxItem.rank = index;\r\n            box_c.boxItem.row = i;\r\n            box_c.boxItem.color_type = (cc.random0To1()*5) | 0;\r\n\r\n            box_c.resetOriginPos();\r\n\r\n            box.parent = this.super_node;\r\n\r\n            rank_list.push(box);\r\n        }\r\n\r\n        this.rankList.push(rank_list);\r\n\r\n\r\n    },\r\n\r\n    //更新所有列 end y的数据\r\n    updateAllRankEndY:function(){\r\n\r\n        //看该列的数量是否 小于 this.num_row  少于的话则补充\r\n        for(let i = 0; i<this.num_rank; i++){\r\n\r\n            let origin_x = this.margin_left + (this.itemWidth+this.itemSpace)*i;\r\n\r\n            let list_sub = this.rankList[i];\r\n            \r\n            while(list_sub.length < this.num_row){\r\n\r\n                let new_box = this.boxDrop_get();\r\n                new_box.active = true;\r\n\r\n                let box_c = new_box.getComponent(\"BoxDrop\");\r\n\r\n                box_c.boxItem.begin_x = origin_x;\r\n                box_c.boxItem.begin_y = this.margin_top;\r\n                box_c.boxItem.rank = i;\r\n                box_c.boxItem.row = 0;\r\n                box_c.boxItem.color_type = (cc.random0To1()*5) | 0;\r\n                box_c.resetOriginPos();\r\n\r\n                new_box.parent = this.super_node;\r\n\r\n                list_sub.push(new_box);\r\n\r\n            }\r\n\r\n\r\n\r\n\r\n            // let list = this.rankList[index];\r\n\r\n            //更新每个元素的end y 位置\r\n            for (let i = 0; i<list_sub.length; i++){\r\n\r\n                let item_box = list_sub[i];\r\n                let box_c = item_box.getComponent(\"BoxDrop\");\r\n\r\n                box_c.boxItem.row = i;\r\n                box_c.boxItem.end_y = this.margin_bottom + (this.itemHeight+this.itemSpace)*(i+1);\r\n            }\r\n        }\r\n\r\n        this.updateBeginOriginY();\r\n\r\n        if(this.gamestate === Game_State.Start){\r\n            this.checkPanelEliminatable();\r\n        }\r\n        // else if(this.gamestate === Game_State.Filling){\r\n        //     // cc.director.getScheduler().schedule(callback, this, interval, !this._isRunning);\r\n        //\r\n        //     let self = this;\r\n        //\r\n        //     this.callBackFilling = function () {\r\n        //\r\n        //         console.log(\"======定时器刷了=====\");\r\n        //\r\n        //         for (let i = 0; i<self.num_rank; i++) {\r\n        //             let list = self.rankList[i];\r\n        //\r\n        //             for (let j = 0; j < self.num_row; j++) {\r\n        //                 let box = list[j];\r\n        //                 let box_c_i = box.getComponent(\"BoxDrop\");\r\n        //                 if(box_c_i.state_b !== BoxState.EFalled){\r\n        //                     return;\r\n        //                 }\r\n        //             }\r\n        //         }\r\n        //\r\n        //         console.log(\"=========检测是否开消除=========\");\r\n        //\r\n        //         self.unschedule(self.callBackFilling);\r\n        //\r\n        //         self.checkPanelEliminatable();\r\n        //     }\r\n        //\r\n        //\r\n        //     //判断他是否所有方块已掉落到指定位置\r\n        //     //这边如果bind this的话 定时器停不下来\r\n        //     this.schedule(this.callBackFilling,0.2);\r\n        // }\r\n\r\n    },\r\n\r\n    /**\r\n     * 更新每一列他们中的每个元素的初始的origin y的值\r\n     */\r\n    updateBeginOriginY:function () {\r\n\r\n\r\n        /**\r\n         * 某一列中 从最后开始遍历返回\r\n         * 算出开始掉了的位置\r\n         */\r\n        for (let i = 0; i<this.num_rank; i++){\r\n            let list = this.rankList[i];\r\n\r\n            //判断是否 已达到他的endy 如果还未达到就是 正要掉落\r\n            let off_top = 0;\r\n            let space_top = 5;\r\n\r\n            // for(let j = this.num_row-1; j>=0; j--){\r\n            for(let j = 0; j<this.num_row; j++){\r\n                let box = list[j];\r\n\r\n                let box_c = box.getComponent(\"BoxDrop\");\r\n                //box_c.boxItem.begin_y = this.margin_top;\r\n\r\n                if(box_c.node.y !== box_c.boxItem.end_y){\r\n\r\n                    /**\r\n                     * 1.实例游戏的时候 初始开始的位置\r\n                     * 2.消除的 方块不在界面中的设置他的开始位置 已在界面中的不去设置他\r\n                     */\r\n                    if((this.gamestate === Game_State.Start) || (box_c.node.y >= box_c.boxItem.begin_y)){\r\n\r\n                        box_c.boxItem.begin_y = this.margin_top + off_top;\r\n\r\n                        box_c.node.y = box_c.boxItem.begin_y;\r\n\r\n                        off_top = off_top + box_c.node.height + space_top;\r\n\r\n                        space_top = space_top + 10;\r\n                    }\r\n\r\n                    //是要掉落的\r\n                    if(this.gamestate === Game_State.Play ||\r\n                        this.gamestate === Game_State.Filling ||\r\n                        this.gamestate === Game_State.Start){\r\n                        box_c.state_b = BoxState.EFalling;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    \r\n    //交换两个方块的位置\r\n    exchangeBoxItem:function(box1,box2,toCheckViable = true){\r\n\r\n        let boxItem1 = box1.getComponent(\"BoxDrop\").boxItem;\r\n        let boxItem2 = box2.getComponent(\"BoxDrop\").boxItem;\r\n\r\n        if(boxItem1.rank === boxItem2.rank){\r\n            //同一列的\r\n            let list = this.rankList[boxItem1.rank];\r\n\r\n            //交换位置\r\n            let temp_endy = boxItem2.end_y;\r\n            boxItem2.end_y = boxItem1.end_y;\r\n            boxItem1.end_y = temp_endy;\r\n\r\n            box1.node.runAction(cc.moveTo(0.2,cc.p(boxItem1.begin_x,boxItem1.end_y)));\r\n            box2.node.runAction(cc.moveTo(0.2,cc.p(boxItem2.begin_x,boxItem2.end_y)));\r\n            // box1.node.y = boxItem1.end_y;\r\n            // box2.node.y = boxItem2.end_y;\r\n\r\n            //交换信息\r\n            let temp_row = boxItem2.row;\r\n\r\n            boxItem2.row = boxItem1.row;\r\n            boxItem1.row = temp_row;            \r\n\r\n            let temp_node = list[boxItem1.row];\r\n            list[boxItem1.row] = list[boxItem2.row];\r\n            list[boxItem2.row] = temp_node;\r\n\r\n\r\n\r\n        }else if(boxItem1.row === boxItem2.row){\r\n            //同一行的\r\n            let list1 = this.rankList[boxItem1.rank];\r\n            let list2 = this.rankList[boxItem2.rank];\r\n\r\n            //交换位置\r\n            let temp_beginx = boxItem2.begin_x;\r\n            boxItem2.begin_x = boxItem1.begin_x;\r\n            boxItem1.begin_x = temp_beginx;\r\n\r\n            box1.node.runAction(cc.moveTo(0.2,cc.p(boxItem1.begin_x,boxItem1.end_y)));\r\n            box2.node.runAction(cc.moveTo(0.2,cc.p(boxItem2.begin_x,boxItem2.end_y)));\r\n            // box1.node.y = boxItem1.end_y;\r\n            // box2.node.y = boxItem2.end_y;\r\n\r\n            //交换信息\r\n            let temp_rank = boxItem2.rank;\r\n            boxItem2.rank = boxItem1.rank;\r\n            boxItem1.rank = temp_rank;\r\n\r\n            let row_index = boxItem1.row;\r\n            let temp_node = list1[row_index];\r\n            list1[row_index] = list2[row_index];\r\n            list2[row_index] = temp_node;\r\n        }\r\n\r\n        \r\n        if(toCheckViable){\r\n\r\n            let isViable = this.checkPanelEliminatable();\r\n\r\n            if(!isViable){\r\n\r\n                //不可消除的话 位置再互换回来\r\n                console.log(\"不可消除\");\r\n                setTimeout(function() {\r\n                this.exchangeBoxItem(box2,box1,false);\r\n                }.bind(this), 300);\r\n            }\r\n        }\r\n    },\r\n\r\n    //检测面板所有方块 是否可消除\r\n    checkPanelEliminatable:function(){\r\n\r\n        let wipe_list = [];\r\n\r\n        //判断列 是否有三个以及三个以上的一样的色块连在一起\r\n        for (let i = 0; i<this.num_rank; i++){\r\n            let list = this.rankList[i];\r\n            let tempList = [];\r\n            let pre_box = null;\r\n            for(let j = 0; j<this.num_row; j++){\r\n                let box = list[j];\r\n                if(!pre_box){\r\n                    pre_box = box;\r\n                    tempList.push(box);\r\n                }else{\r\n                    let item_pre = pre_box.getComponent(\"BoxDrop\").boxItem;\r\n                    let item_box = box.getComponent(\"BoxDrop\").boxItem;\r\n\r\n                    let toAdd = false;\r\n                    if(item_pre.color_type === item_box.color_type){\r\n                        tempList.push(box);\r\n                        if(j === (this.num_row-1)){\r\n                            toAdd = true;\r\n                        }\r\n                    }else{\r\n                        toAdd = true;\r\n                    }\r\n\r\n                    if(toAdd){\r\n                        if(tempList.length >= 3){\r\n                            //追加到wipe里面\r\n                            Array.prototype.push.apply(wipe_list,tempList);\r\n\r\n                        }\r\n                        //清空数组\r\n                        tempList = [];\r\n\r\n                        pre_box = box;\r\n                        tempList.push(box);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        function isRepeatItemInWipe(item){\r\n            for(let i = 0; i<wipe_list.length; i++){\r\n                if(wipe_list[i].getComponent(\"BoxDrop\").boxItem.id === item.getComponent(\"BoxDrop\").boxItem.id){\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        //判断行 是否有三个以及三个以上的一样的色块连在一起\r\n        for (let i = 0; i<this.num_row; i++){\r\n            \r\n            let tempList = [];\r\n            let pre_box = null;\r\n            for(let j = 0; j<this.num_rank; j++){\r\n                let box = this.rankList[j][i];\r\n                if(!pre_box){\r\n                    pre_box = box;\r\n                    tempList.push(box);\r\n                }else{\r\n                    let item_pre = pre_box.getComponent(\"BoxDrop\").boxItem;\r\n                    let item_box = box.getComponent(\"BoxDrop\").boxItem;\r\n\r\n                    let toAdd = false;\r\n                    if(item_pre.color_type === item_box.color_type){\r\n                        tempList.push(box);\r\n                        if(j === (this.num_rank-1)){\r\n                            toAdd = true;\r\n                        }\r\n                    }else{\r\n                        toAdd = true;\r\n                    }\r\n\r\n                    if(toAdd){\r\n                        if(tempList.length >= 3){\r\n                            //追加到wipe里面\r\n                            tempList.forEach(function(elem){\r\n\r\n                                if(!isRepeatItemInWipe(elem)){\r\n                                    wipe_list.push(elem);\r\n                                }\r\n\r\n\r\n                            });\r\n\r\n                        }\r\n                        //清空数组\r\n                        tempList = [];\r\n\r\n                        pre_box = box;\r\n                        tempList.push(box);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        if(wipe_list.length > 0){\r\n\r\n            let showDelayAnimation = true;\r\n            if(this.gamestate === Game_State.Start){\r\n                //不显示消除动画\r\n                showDelayAnimation = false;\r\n            }\r\n\r\n\r\n\r\n\r\n            //#warn\r\n            //这一块 逻辑 有问题\r\n\r\n            if(showDelayAnimation) {\r\n                this.schedule(function () {\r\n                    //状态设置成是摧毁\r\n                    wipe_list.forEach(function (elem) {\r\n\r\n                        let box = elem.getComponent(\"BoxDrop\");\r\n                        box.state_b = BoxState.EDestroy;\r\n\r\n                    }.bind(this));\r\n                }, 0.3, 1);\r\n            }\r\n\r\n\r\n\r\n            //不是初始化的 停留一会儿再消除\r\n            this.schedule(function () {\r\n\r\n                //消除掉\r\n                wipe_list.forEach(function(elem){\r\n\r\n                    this.boxDrop_destroy(elem.getComponent(\"BoxDrop\"));\r\n\r\n                }.bind(this));\r\n\r\n                //有销毁在掉落\r\n                if(showDelayAnimation){\r\n                    //正在掉落填充\r\n                    this.gamestate = Game_State.Filling;\r\n                }\r\n\r\n                this.updateAllRankEndY();\r\n\r\n            }.bind(this),showDelayAnimation?0.6:0,false);\r\n\r\n            return true;\r\n        }\r\n\r\n        this.gamestate = Game_State.Play;\r\n\r\n        return false;\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    boxDrop_get:function(){\r\n\r\n        let box = null;\r\n        if(this.boxPool.size() > 0){\r\n            box = this.boxPool.get();\r\n        }else{\r\n            box = cc.instantiate(this.box_prefab);\r\n            box.getComponent(\"BoxDrop\").init();\r\n        }\r\n\r\n        return box;\r\n    },\r\n\r\n    boxDrop_destroy:function(box){\r\n\r\n        let list = this.rankList[box.boxItem.rank];\r\n        \r\n        list.removeByValue(list,box.node);\r\n\r\n        this.boxPool.put(box.node);\r\n    },\r\n\r\n\r\n\r\n    \r\n\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n\r\n        if(this.gamestate === Game_State.Filling){\r\n            // cc.director.getScheduler().schedule(callback, this, interval, !this._isRunning);\r\n\r\n            let self = this;\r\n\r\n            if(this.fillInterval === 10){\r\n\r\n                this.fillInterval = 0;\r\n\r\n                console.log(\"======定时开始判断是否都已掉落到底部了=====\");\r\n\r\n                for (let i = 0; i<self.num_rank; i++) {\r\n                    let list = self.rankList[i];\r\n\r\n                    for (let j = 0; j < self.num_row; j++) {\r\n                        let box = list[j];\r\n                        let box_c_i = box.getComponent(\"BoxDrop\");\r\n                        if(box_c_i.state_b !== BoxState.EFalled){\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                console.log(\"=========检测是否开消除=========\");\r\n\r\n                this.gamestate === Game_State.Play;\r\n                self.checkPanelEliminatable();\r\n            }\r\n\r\n            this.fillInterval += 1;\r\n        }\r\n\r\n    },\r\n});\r\n\r\n\r\n"
  ]
}